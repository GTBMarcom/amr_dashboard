<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AGV ROI Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@1.1.0"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    .model-card img {
      object-fit: contain;
      width: 100%;
      height: auto;
    }
    .scrollbar::-webkit-scrollbar {
      width: 8px;
    }
    .scrollbar::-webkit-scrollbar-thumb {
      background-color: #cbd5e0;
      border-radius: 4px;
    }
  </style>
</head>
<body class="bg-gray-100 text-gray-900">
<div class="flex min-h-screen">
  <!-- Sidebar -->
  <aside class="w-72 bg-white border-r border-gray-300 p-4 overflow-y-auto scrollbar">
    <h2 class="text-lg font-bold mb-4">DASHBOARD HOME</h2>
    <div>
      <div class="mb-4">
        <label class="block font-semibold mb-2">카테고리</label>
        <select id="category-select" class="w-full border border-gray-300 rounded px-3 py-2">
          <option value="저상형">저상형</option>
          <option value="분류형">분류형</option>
          <option value="운반형">운반형</option>
          <option value="지게형">지게형</option>
        </select>
      </div>
      <div id="model-list" class="space-y-4"></div>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="flex-1 p-6 overflow-auto">
    <h1 class="text-2xl font-bold mb-6">ROI 분석 대시보드</h1>
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
      <div>
        <h2 class="text-lg font-semibold mb-2">손익분기점 (24개월)</h2>
        <canvas id="roiChart" width="1600" height="800"></canvas>
      </div>
      <div>
        <h2 class="text-lg font-semibold mb-2">월간 투자 대비 인건비 손익비</h2>
        <canvas id="savingChart" width="1600" height="800"></canvas>
      </div>
    </div>
  </main>
</div>

<script>
const models = {
  "저상형": [
    { name: "M6-300N", image: "http://gtbkorea.com/board/download/424b70200f0fdedb814795970d94d737", cost: 24000000, monthlySavings: 1600000 },
    { name: "M6-600", image: "http://gtbkorea.com/board/download/f707273357c45ecf554f773fcc29b27d", cost: 26000000, monthlySavings: 1700000 },
    { name: "M6-800", image: "http://gtbkorea.com/board/download/21b35da19c4cdbec537d7b752d16e351", cost: 28000000, monthlySavings: 1850000 },
    { name: "T6-1200/1500", image: "http://gtbkorea.com/board/download/e6e56ad00518e93b696b0cd0a1293904", cost: 33000000, monthlySavings: 1950000 },
    { name: "YAF10", image: "http://gtbkorea.com/board/download/724be54bff8b685721fad714c04e8f50", cost: 37000000, monthlySavings: 2100000 },
    { name: "YAH10", image: "http://gtbkorea.com/board/download/624fbdccc2c937f8e29edc04bf0a7584", cost: 39500000, monthlySavings: 2250000 },
  ],
  "분류형": [
    { name: "Z50-SF", image: "http://gtbkorea.com/board/download/2340dd9e5e0ae97f88b4c2e90dcb2cf8", cost: 41000000, monthlySavings: 2450000 },
    { name: "Z50-S", image: "http://gtbkorea.com/board/download/0ab50609721b1de4baee87e07cb5905d", cost: 43000000, monthlySavings: 2550000 },
    { name: "F50A", image: "http://gtbkorea.com/board/download/b0923cce7cdfaa31395dcd5ea71bd6cc", cost: 44000000, monthlySavings: 2600000 },
    { name: "F152/F152-XL", image: "http://gtbkorea.com/board/download/16e8be0a9203575f8c99231c17a4066f", cost: 46000000, monthlySavings: 2750000 },
  ],
  "운반형": [
    { name: "ZS-H150", image: "http://gtbkorea.com/board/download/080f97a986659ce4bc5f1cd0a12d09eb", cost: 47000000, monthlySavings: 2800000 },
    { name: "ZS-H120", image: "http://gtbkorea.com/board/download/623c0699c75a3799df83991be50d1fdd", cost: 48000000, monthlySavings: 2900000 },
    { name: "ZS-L2000", image: "http://gtbkorea.com/board/download/1f3f9da6d6129fe410548eef36b370c1", cost: 49500000, monthlySavings: 3000000 },
    { name: "ZS 고객요청용", image: "http://gtbkorea.com/board/download/1fe5784d235d5426ff8d75ad98f081c1", cost: 51000000, monthlySavings: 3100000 },
    { name: "YAG10", image: "http://gtbkorea.com/board/download/8f55e3677844a1d2983db42f19d42567", cost: 52000000, monthlySavings: 3200000 },
    { name: "CONVEYOR", image: "http://gtbkorea.com/board/download/6c60053620b9f87b62afed043953fa8a", cost: 53000000, monthlySavings: 3300000 },
  ],
  "지게형": [
    { name: "YAA10", image: "http://gtbkorea.com/board/download/125d1ba1e7c70688aa4d162e7f5d7020", cost: 54000000, monthlySavings: 3400000 },
    { name: "YAB10", image: "http://gtbkorea.com/board/download/c7c166dedf97859f798f5e0f1cf271b2", cost: 55000000, monthlySavings: 3500000 },
    { name: "YAB16", image: "http://gtbkorea.com/board/download/5a240a7b5b1cdaa612d8d26fac031ff4", cost: 56000000, monthlySavings: 3600000 },
    { name: "YAP10", image: "http://gtbkorea.com/board/download/a9a30860335be0d79f13c6cd89a12510", cost: 57000000, monthlySavings: 3700000 },
    { name: "YAF30", image: "http://gtbkorea.com/board/download/aae163cad4b249d7bfe9e7a64a855a97", cost: 58000000, monthlySavings: 3800000 },
    { name: "YAP30-10", image: "http://gtbkorea.com/board/download/5ec58fb27b7a282601214eadeda73d86", cost: 59000000, monthlySavings: 3900000 },
    { name: "YAG30", image: "http://gtbkorea.com/board/download/441491fb716d3a7c0fc3618d051eb2d0", cost: 60000000, monthlySavings: 4000000 },
    { name: "YAA35", image: "http://gtbkorea.com/board/download/c8ce53e70635340519eb46a62b984639", cost: 61000000, monthlySavings: 4100000 },
    { name: "YAB35", image: "http://gtbkorea.com/board/download/53ede872548fcb0bca9e52c560a09ef0", cost: 62000000, monthlySavings: 4200000 },
  ]
};

function updateModelList(category) {
  const container = document.getElementById('model-list');
  container.innerHTML = '';
  models[category].forEach(model => {
    const el = document.createElement('div');
    el.className = 'border border-gray-300 rounded p-3 model-card bg-white';
    el.innerHTML = `
      <div class="flex items-center gap-4">
        <img src="${model.image}" alt="${model.name}" class="w-20 h-16" />
        <div>
          <div class="text-lg font-bold">${model.name}</div>
          <div class="text-sm">도입비용: ${model.cost.toLocaleString()}원</div>
          <div class="text-sm">월 절감액: ${model.monthlySavings.toLocaleString()}원</div>
        </div>
      </div>`;
    el.onclick = () => renderCharts(model);
    container.appendChild(el);
  });
}

document.getElementById('category-select').addEventListener('change', e => {
  updateModelList(e.target.value);
});

window.addEventListener('DOMContentLoaded', () => {
  updateModelList('저상형');
});

let roiChart;
let savingChart;

function renderCharts(model) {
  const months = Array.from({ length: 24 }, (_, i) => `${i + 1}개월`);
  const cumulativeSavings = months.map((_, i) => model.monthlySavings * (i + 1));
  const roiData = cumulativeSavings.map(s => s - model.cost);

  const breakpointIndex = roiData.findIndex(v => v >= 0);

  if (roiChart) roiChart.destroy();
  roiChart = new Chart(document.getElementById('roiChart'), {
    type: 'line',
    data: {
      labels: months,
      datasets: [{
        label: '누적 수익',
        data: roiData,
        fill: true,
        borderColor: '#2563eb',
        backgroundColor: 'rgba(37,99,235,0.1)',
        pointBackgroundColor: '#2563eb'
      }]
    },
    options: {
      responsive: false,
      plugins: {
        annotation: breakpointIndex >= 0 ? {
          annotations: {
            line: {
              type: 'line',
              xMin: breakpointIndex,
              xMax: breakpointIndex,
              borderColor: 'red',
              borderWidth: 2,
              label: {
                content: '손익분기점',
                enabled: true,
                position: 'top'
              }
            }
          }
        } : {}
      },
      scales: {
        y: {
          ticks: {
            callback: v => `${(v / 10000).toFixed(0)}만원`,
            stepSize: 5000000
          }
        }
      }
    }
  });

  if (savingChart) savingChart.destroy();
  savingChart = new Chart(document.getElementById('savingChart'), {
    type: 'bar',
    data: {
      labels: months,
      datasets: [{
        label: '월 절감액',
        data: months.map(() => model.monthlySavings),
        backgroundColor: '#059669'
      }]
    },
    options: {
      responsive: false,
      scales: {
        y: {
          ticks: {
            callback: v => `${(v / 10000).toFixed(0)}만원`,
            stepSize: 5000000
          }
        }
      }
    }
  });
}
</script>
</body>
</html>
