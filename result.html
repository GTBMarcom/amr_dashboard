<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AGV/AMR ROI 시뮬레이션 대시보드</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .scrollbar-hide::-webkit-scrollbar {
      display: none;
    }
  </style>
</head>
<body class="bg-[#f7f8fa] text-[#080b12]">
  <div class="flex h-screen">
    <!-- 좌측 메뉴 -->
    <aside class="w-80 bg-white border-r border-gray-200 p-4 overflow-y-auto scrollbar-hide">
      <h2 class="text-xl font-bold mb-4">카테고리 선택</h2>
      <select id="categorySelect" class="w-full mb-4 border rounded px-3 py-2">
        <option value="저상형">저상형</option>
        <option value="분류형">분류형</option>
        <option value="운반형">운반형</option>
        <option value="지게형">지게형</option>
      </select>
      <div id="modelList" class="space-y-4"></div>
    </aside>

    <!-- 우측 콘텐츠 -->
    <main class="flex-1 p-6 overflow-y-auto">
      <div class="flex justify-between items-center mb-6">
        <h1 class="text-2xl font-bold">ROI 분석 대시보드</h1>
        <button id="downloadPdf" class="bg-[#080b12] text-white px-4 py-2 rounded">PDF 저장하기</button>
      </div>

      <!-- 사용자 입력폼 -->
      <div class="grid grid-cols-2 gap-4 mb-8">
        <div><label>1교대당 직원수</label><input type="number" id="employees" class="w-full border rounded px-3 py-2" value="3"></div>
        <div><label>시간당 비용 (원)</label><input type="number" id="hourlyCost" class="w-full border rounded px-3 py-2" value="15000"></div>
        <div><label>1교대 시간</label><input type="number" id="shiftHours" class="w-full border rounded px-3 py-2" value="8"></div>
        <div><label>1일당 교대</label><input type="number" id="shiftsPerDay" class="w-full border rounded px-3 py-2" value="2"></div>
        <div><label>주간 운영일수</label><input type="number" id="daysPerWeek" class="w-full border rounded px-3 py-2" value="5"></div>
        <div><label>연간 생산주간</label><input type="number" id="weeksPerYear" class="w-full border rounded px-3 py-2" value="50"></div>
      </div>

      <!-- 그래프 1: ROI 손익분기점 -->
      <div class="bg-white p-4 rounded mb-8">
        <h2 class="text-xl font-bold mb-2">ROI 손익분기점</h2>
        <canvas id="roiChart" width="1600" height="800"></canvas>
      </div>

      <!-- 그래프 2: 월별 투자대비 절감비 -->
      <div class="bg-white p-4 rounded">
        <h2 class="text-xl font-bold mb-2">월별 투자 대비 절감 추이</h2>
        <canvas id="savingsChart" width="1600" height="800"></canvas>
      </div>
    </main>
  </div>

  <script>
const models = [
  // 저상형 (6종)
  { name: "M6-300N", category: "저상형", image: "http://gtbkorea.com/board/download/424b70200f0fdedb814795970d94d737", cost: 30000000 },
  { name: "M6-600", category: "저상형", image: " http://gtbkorea.com/board/download/f707273357c45ecf554f773fcc29b27d", cost: 32000000 },
  { name: "M6-800", category: "저상형", image: "http://gtbkorea.com/board/download/21b35da19c4cdbec537d7b752d16e351", cost: 34000000 },
  { name: "T6-1200/1500", category: "저상형", image: "http://gtbkorea.com/board/download/e6e56ad00518e93b696b0cd0a1293904", cost: 36000000 },
  { name: "YAF10", category: "저상형", image: "http://gtbkorea.com/board/download/724be54bff8b685721fad714c04e8f50", cost: 38000000 },
  { name: "YAH10", category: "저상형", image: "http://gtbkorea.com/board/download/624fbdccc2c937f8e29edc04bf0a7584", cost: 39000000 },

  // 분류형 (6종)
  { name: "Z50-SF", category: "분류형", image: "http://gtbkorea.com/board/download/2340dd9e5e0ae97f88b4c2e90dcb2cf8", cost: 35000000 },
  { name: "Z50-S", category: "분류형", image: "http://gtbkorea.com/board/download/0ab50609721b1de4baee87e07cb5905d", cost: 36000000 },
  { name: "F50A", category: "분류형", image: "http://gtbkorea.com/board/download/b0923cce7cdfaa31395dcd5ea71bd6cc", cost: 37000000 },
  { name: "F152/F152-XL", category: "분류형", image: "http://gtbkorea.com/board/download/16e8be0a9203575f8c99231c17a4066f", cost: 38000000 },


  // 운반형 (6종)
  { name: "ZS-H150", category: "운반형", image: "http://gtbkorea.com/board/download/080f97a986659ce4bc5f1cd0a12d09eb", cost: 42000000 },
  { name: "ZS-H120", category: "운반형", image: "http://gtbkorea.com/board/download/623c0699c75a3799df83991be50d1fdd", cost: 44000000 },
  { name: "ZS-L2000", category: "운반형", image: " http://gtbkorea.com/board/download/1f3f9da6d6129fe410548eef36b370c1", cost: 46000000 },
  { name: "ZS 고객요청용", category: "운반형", image: "http://gtbkorea.com/board/download/1fe5784d235d5426ff8d75ad98f081c1", cost: 47000000 },
  { name: "YAG10", category: "운반형", image: "http://gtbkorea.com/board/download/8f55e3677844a1d2983db42f19d42567", cost: 48000000 },
  { name: "CONVEYOR", category: "운반형", image: "http://gtbkorea.com/board/download/6c60053620b9f87b62afed043953fa8a", cost: 49000000 },

  // 지게형 (6종)
  { name: "YAA10", category: "지게형", image: "http://gtbkorea.com/board/download/125d1ba1e7c70688aa4d162e7f5d7020", cost: 45000000 },
  { name: "YAB10", category: "지게형", image: "http://gtbkorea.com/board/download/c7c166dedf97859f798f5e0f1cf271b2", cost: 47000000 },
  { name: "YAB16", category: "지게형", image: "http://gtbkorea.com/board/download/5a240a7b5b1cdaa612d8d26fac031ff4", cost: 49000000 },
  { name: "YAP10", category: "지게형", image: "http://gtbkorea.com/board/download/a9a30860335be0d79f13c6cd89a12510", cost: 51000000 },
  { name: "YAF30", category: "지게형", image: "http://gtbkorea.com/board/download/aae163cad4b249d7bfe9e7a64a855a97", cost: 53000000 },
  { name: "YAP30-10", category: "지게형", image: "http://gtbkorea.com/board/download/5ec58fb27b7a282601214eadeda73d86", cost: 53000000 },
  { name: "YAG30", category: "지게형", image: "http://gtbkorea.com/board/download/441491fb716d3a7c0fc3618d051eb2d0", cost: 53000000 },
  { name: "YAA35", category: "지게형", image: "http://gtbkorea.com/board/download/c8ce53e70635340519eb46a62b984639", cost: 53000000 },
  { name: "YAB35", category: "지게형", image: "http://gtbkorea.com/board/download/53ede872548fcb0bca9e52c560a09ef0", cost: 55000000 }
];


    const categorySelect = document.getElementById("categorySelect");
    const modelList = document.getElementById("modelList");
    const charts = {};

    function updateModelList() {
      const selectedCategory = categorySelect.value;
      modelList.innerHTML = "";
      const filtered = models.filter(m => m.category === selectedCategory);
      filtered.forEach(model => {
        const div = document.createElement("div");
        div.className = "flex gap-4 p-2 border rounded cursor-pointer hover:bg-gray-50";
        div.innerHTML = `
          <img src="${model.image}" alt="${model.name}" class="w-24 h-16 object-contain">
          <div>
            <h4 class="font-bold">${model.name}</h4>
            <p class="text-sm">도입비용: ${model.cost.toLocaleString()}원</p>
          </div>
        `;
        div.onclick = () => calculateROI(model);
        modelList.appendChild(div);
      });
    }

    function calculateROI(model) {
      const employees = +document.getElementById("employees").value;
      const hourlyCost = +document.getElementById("hourlyCost").value;
      const shiftHours = +document.getElementById("shiftHours").value;
      const shiftsPerDay = +document.getElementById("shiftsPerDay").value;
      const daysPerWeek = +document.getElementById("daysPerWeek").value;
      const weeksPerYear = +document.getElementById("weeksPerYear").value;

      const monthlyLaborCost = employees * hourlyCost * shiftHours * shiftsPerDay * daysPerWeek * 4;
      const cost = model.cost;

      const labels = Array.from({ length: 24 }, (_, i) => `${i + 1}개월`);
      const cumulativeSavings = labels.map((_, i) => monthlyLaborCost * (i + 1));
      const investment = labels.map(() => cost);

      if (charts.roiChart) charts.roiChart.destroy();
      charts.roiChart = new Chart(document.getElementById("roiChart"), {
        type: 'line',
        data: {
          labels,
          datasets: [
            { label: '누적 절감액', data: cumulativeSavings, borderColor: '#4caf50', fill: false },
            { label: '도입비용', data: investment, borderColor: '#f44336', fill: false }
          ]
        },
        options: {
          responsive: false,
          plugins: {
            zoom: {
              zoom: { wheel: { enabled: true }, pinch: { enabled: true }, mode: 'xy' },
              pan: { enabled: true, mode: 'xy' }
            }
          },
          scales: {
            y: {
              ticks: { stepSize: 5000000, callback: v => (v / 10000) + '만원' }
            }
          }
        }
      });

      if (charts.savingsChart) charts.savingsChart.destroy();
      charts.savingsChart = new Chart(document.getElementById("savingsChart"), {
        type: 'bar',
        data: {
          labels,
          datasets: [
            { label: '월별 절감액', data: Array(24).fill(monthlyLaborCost), backgroundColor: '#2196f3' }
          ]
        },
        options: {
          responsive: false,
          plugins: {
            zoom: {
              zoom: { wheel: { enabled: true }, pinch: { enabled: true }, mode: 'xy' },
              pan: { enabled: true, mode: 'xy' }
            }
          },
          scales: {
            y: {
              ticks: { stepSize: 5000000, callback: v => (v / 10000) + '만원' }
            }
          }
        }
      });
    }

    document.getElementById("downloadPdf").addEventListener("click", () => {
      const element = document.body;
      html2pdf().from(element).set({ margin: 0.2, filename: 'roi-dashboard.pdf', html2canvas: { scale: 2 } }).save();
    });

    categorySelect.addEventListener("change", updateModelList);
    updateModelList();
  </script>
</body>
</html>
